---
title: "README"
author: "Muhammad Saif Imtiaz"
date: "2024-12-07"
output: html_document
---
Before begining to read this project, I understand that many of you will struggle
with some cricket terminologies. For that reason I have included an additional
Glossary file within the repository for you to look at and make some sense of my data anf findings


# Quick Guide to Running the Babar Azam Analysis Project

**Quick Summary of How to Run This Project**

1. **Install Libraries**
   - Open the `data.R` file and install all the relevant libraries required for the project. Ensure all packages mentioned in the dependencies are correctly installed.

2. **Generate Static Plots**
   - Run the code in the section titled **"For Static Plots"** in the `data.R` file.
   - Then, open the `staticplot.R` file and execute the entire code chunk to generate various static visualizations.

3. **Regression Analysis**
   - A good starting point would be to move to the `model.R` file and execute the entire code chunk to view the regression analysis. This provides findings into Babar Azam’s performance, both as a player and as a captain.

4. **Explore Team Performance via Shiny App**
   - Open the `shinyapp.R` file to explore an interactive analysis of the team’s progression under Babar’s captaincy. 
   - Use this to assess whether any improvements during his tenure are attributed to his skills or external factors, such as toss outcomes.

5. **Natural Language Processing (NLP)**
   - For NLP-related analysis, return to the `data.R` file and run the code in the section titled **"For Text Processing."** 
   - This step prepares the textual data for further analysis.

6. **Sentiment Analysis and Word Associations**
   - Open the `textprocess.R` file:
     - Run the code until line 62 to generate a chart showing the **Average Sentiment for Babar Azam**.
     - Continue running the remaining code to view summary statistics and extract lexicons for sentiment and word associations.


Below you will find a detailed description for every R file contained within the 
project repository:

# data.R file


**Summary**

The `data.R` file contains:


1. **Retrieval of Babar Azam's performance data** using the `cricketdata` package. It processes and organizes his ODI performance data, marking key details such as match dates, home/away status, and captaincy periods.


2. **Web scraping of articles related to Babar Azam** from the ICC website, saving the raw text data locally for further analysis.


3. **Preprocessing of datasets**, including filtering relevant articles, organizing metadata, and saving cleaned versions of the datasets in the `data/` folder.

**Purpose**

This file is the **foundation of the project** and must be executed before running any ancillary files. It ensures that all necessary data is retrieved, cleaned, and stored for further use. =

**Key Outputs**

- **Babar Azam's performance data**: Saved as `data/babar_data.csv` and contains cleaned and structured data for static plots, regression models, and Shiny apps.

- **Article data**: 
  
  - Raw scraped articles saved as `data/articles_raw.txt`.
  
  - Filtered articles specifically mentioning Babar Azam saved as `data/filtered_articles.txt`.
  
  - Associated article titles saved as `data/filtered_titles.txt`.

**Dependency for Other Scripts**

Most of the analysis scripts in this project are dependent on the outputs generated by this file:

- **Static Plots**: The `babar_data.csv` file is used for generating insights such as career trends and performance comparisons.

- **Text Processing and Sentiment Analysis**: The `filtered_articles.txt` file provides the basis for sentiment scoring and text analysis.

- **Regression Models**: Processed performance data from `babar_data.csv` is used for evaluating trends in Babar Azam's performance.

**Instructions for Use**

1. Ensure all required libraries are installed before running the file. Necessary packages include:
   - `cricketdata`
   - `dplyr`
   - `tidyverse`
   - `rvest`

2. Execute this file in its entirety to retrieve, clean, and store the data. The file automatically saves cleaned datasets in the `data/` folder for future use.

3. Replace online data retrieval with saved files if needed:
   - To use saved performance data: `read_csv("data/babar_data.csv")`.
   - To use saved articles: `read_lines("data/articles_raw.txt")` or `read_lines("data/filtered_articles.txt")`.

**Notes for Reproducibility**
- The `use_local` flag in this file enables switching between archived and live data retrieval.
- If running the project in a different environment, ensure that the `data/` folder is present and contains the saved outputs from this file.


# Static Plots

**Summary**  

This section contains visualizations analyzing Babar Azam's performance in ODI matches over his career. It focuses on:
- Babar Azam's average ODI runs across his career.
- His performance against major opponents, both before and during his captaincy.

**Data Source**  

The dataset `babar_data` was created and saved as `data/babar_data.csv` during the execution of the `data.R` file. The file was fetched and cleaned Babar Azam's performance data using the `cricketdata` package. Ensure `data.R` has been executed before running these scripts.

**Fetching and Cleaning the Data**  

- Data for this analysis is retrieved from the `babar_data.csv` file.

- Additional processing includes:
  - Calculating average runs across all matches played.
  - Grouping and summarizing performance data by opposition teams and captaincy status.

**Plots**

1. ***Career ODI Average***
   - This visualization highlights Babar Azam's cumulative and average runs over time in ODI matches.
   - A vertical dashed red line marks the start of his captaincy (October 30, 2020).
   - **Image Output**: Saved in the `Images` folder as `Career_Average_ODI.png`.

2. ***Performance Against Opponents***

   - This bar chart compares Babar Azam's average runs against key opponents (Australia, India, England, New Zealand, and South Africa) before and during his captaincy.These teams were selected since they rank
the highest in the Team Rankings
   
   - **Image Output**: Saved in the `Images` folder as `Performance_Against_Opponents.png`.

**Instructions**  

1. Ensure the `data.R` file has been executed to create the `babar_data.csv` dataset.
2. Run the provided code to generate and save the plots in the `Images` folder for further use in reports or presentations.

**Additional Notes**  

- These plots are essential for understanding trends in Babar Azam's career, highlighting key moments and performance metrics.

- Ensure the working directory is set correctly to save images in the `Images` folder.

- The saved images can be directly inserted into any R Markdown report or presentation.


# Shiny App

This repository contains two Shiny Apps that analyze Babar Azam's performance in ODI cricket matches. The first app provides an analysis of the Pakistan cricket team's winning percentage with and without Babar Azam as captain, while the second app presents an interactive map showcasing Babar Azam's centuries during his captaincy and as a regular player. The objective of these apps is to provide a detailed visual and interactive analysis of Babar Azam's impact as a player and a captain.

**Dependencies**

The following R libraries are required:
- `shiny`: For creating interactive web applications.
- `ggplot2`: To create visualizations like bar charts and maps.
- `dplyr`: For data manipulation and transformations.
- `stringr`: For string manipulation in data preparation.

**App 1: Winning Percentage Analysis Against Oppositions**

**Features**
This app allows users to select an opposition team and view the winning percentage of the Pakistan cricket team when Babar Azam is captain compared to when he is not. It includes:

- **A summary table**: Displays matches played and wins during and before Babar Azam's captaincy.
- **A bar chart**: Visualizes the win percentage for matches with and without Babar as captain.

**Data Preparation**

- Dataset: `odi_result.csv`, extracted from Statsguru.

- Processing steps:
  - **Captaincy Status**: Added a column to indicate whether Babar Azam was captain, based on the start date of his captaincy (30th October 2020).

**User Interface**
- **Image Header**: Displays an image of Babar Azam and the Pakistan cricket team.

- **Sidebar Panel**: Provides a dropdown menu for selecting an opposition team.

- **Main Panel**: Displays the summary table and the win percentage bar chart.

**Server Logic**
1. **Reactive Filtering**: Filters data based on the selected opposition.

2. **Summary Table**: Shows:
   - Total matches played.
   - Wins during Babar Azam's captaincy.
   - Wins when Babar was not captain.

3. **Bar Chart**: Visualizes the win percentage for each category.

---

**App 2: Toss Impact Analysis Shiny App**


This app analyzes the impact of winning or losing the toss on match outcomes during Babar Azam's ODI captaincy. It includes:

1. **Toss Impact Visualization**: A bar chart showing win percentage based on toss outcomes (Won Toss or Lost Toss).

2. **Toss Outcome Summary Table**: Displays total matches, wins, losses, no results, and ties.

**Features**

- Interactive filtering by captaincy status (`Captain` or `Not Captain`).

- Dynamic bar chart and summary table with detailed statistics.

**Data Preparation**

- Dataset: `odi_result.csv` extracted from Statsguru.

- Key preprocessing steps:
  1. **Date Conversion**: Converted `Start.Date` to `Date` format (`%d/%m/%Y`).
  2. **Captaincy Status**: Added a column (`Captaincy_Status`) to indicate matches during or before Babar's captaincy.
  3. **Toss Outcome**: Added a column (`Toss_Outcome`) to specify whether Pakistan won or lost the toss.

**Shiny App Components**

**UI**

1. **Title Panel**: Displays the app's title: _"Impact of Toss Wins on Match Results During Babar Azam's Captaincy"_.

2. **Sidebar Panel**: Dropdown menu for filtering by captaincy status (`Captain` or `Not Captain`).

3. **Main Panel**: Displays:
   - A bar chart showing win percentage for toss outcomes.
   - A summary table with toss and match result statistics.

**Server Logic**

1. **Reactive Data Filtering**:
   - Filters data based on the selected captaincy status.
2. **Bar Chart**:
   - Groups data by `Toss_Outcome`.
   - Calculates total matches, wins, and win percentage for each toss outcome.
   - Displays win percentages in a bar chart.
3. **Summary Table**:
   - Groups data by `Toss_Outcome`.
   - Summarizes total matches, wins, losses, no results, and ties.
   - Outputs the data as a table.

---

**File Structure**

**Data**

- **`odi_result.csv`**: Input dataset containing ODI match details.

**App Files**

1. **App 1**: Winning Percentage Analysis.
   - UI: Defines the user interface components.
   - Server: Contains logic for filtering and visualizing win percentages.
2. **App 2**: Toss Impact Analysis.
   - UI: Defines the user interface components.
   - Server: Contains logic for toss outcome analysis.

---

# Model

**Regression Model**

The code evaluates Babar Azam's ODI batting performance to determine whether being the captain of the Pakistan cricket team impacts his performance, and whether he remains an ideal choice for captaincy. The analysis uses data from the `cricketdata` package using Babar's player ID and performs a regression analysis to compare his performance as a captain versus as a regular player. THe analysis assesses whether the additional responsibilities of captaincy influence his individual batting performance.



**Dependencies**

The code requires the following R libraries:

- `cricketdata`: To fetch international cricket data, specifically Babar Azam's ODI matches.
- `dplyr`: For data manipulation and transformations.

**Data Preparation**

The data is transformed to add relevant variables:
- Captaincy_Status: Indicates whether Babar was playing as the captain or not. He became captain on 30th October 2020.
- Home_Away: Specifies whether a match was played at home (Karachi, Lahore, Rawalpindi, Multan) or away.
- Missing values for runs are filtered out to ensure data quality.

**Regression Model**

The regression model is fitted to determine whether captaincy status or playing at home vs. away significantly affects Babar Azam's runs scored.

**Dependent Variable**: Runs (the number of runs scored by Babar Azam in each match).

**Independent Variables**:

- Captaincy_Status: To determine if captaincy impacts performance.

- Home_Away: To assess if playing at home has an effect on runs scored.

- Interaction Term (Captaincy_Status:Home_Away): To see if being captain influences performance differently depending on whether the match was played at home or away.

---


# Text Processing

This project analyzes the sentiment of articles related toBabar Azam’s captaincy 
and the Pakistani cricket team. The analysis leverages sentiment lexicons such as 
AFINN, Bing, and NRC to extract sentiment scores and determine the words most 
associated with positive and negative sentiments in the articles.

---

** Before Running the Code **

The data.R  section, titled "Text Processing" of the code must be executed first to ensure proper text preprocessing and sentiment analysis. This step is critical for preparing the data and extracting relevant insights.

---

**Data Collection and Management**

Articles are automatically scraped from the ICC Cricket website's news section. However, to ensure reproducibility, an archived version of the data is stored in the `data` folder. Users can choose to either scrape the articles again or use the locally stored version by setting the `use_local` variable in the script.

Both the initial unmodified articles (`articles_raw.txt`) and the processed versions (`articles_processed.csv`) are saved in the `data` folder to facilitate reproducibility and easy reference.

---

**Key Features of the Analysis**

- **Sentiment Analysis**: Utilizes AFINN, Bing, and NRC lexicons to determine sentiment scores for each article.

Note that TRUE indicates that the sentiment score (afinn) for an article is positive (greater than 0). This means the article's text contains more positive words or phrases as per the AFINN lexicon.

FALSE indicates that the sentiment score (afinn) for an article is negative (less than or equal to 0). This means the article's text contains more negative words or phrases as per the AFINN lexicon.

- **Text Preprocessing**: Involves steps such as stemming, punctuation removal, and removal of stopwords to prepare the text for analysis.
- **Visualization**: Sentiment scores are visualized using `ggplot2` for clear and insightful presentation.
- **Word Association**: Identifies the top words associated with positive and negative sentiments using the different lexicons.

---

**Notes on Usage**

- The initial data (`articles_raw.txt`) and the final processed data (`articles_processed.csv`) are both archived in the `data` folder for easy access and reproducibility.

---

**Dependencies**

The following R packages are required for running the scripts:

- `tidyverse`: For data manipulation and visualization.
- `tidytext`: For text mining and analysis.
- `udpipe`: For text processing and dependency parsing.
- `ggraph`: For creating network visualizations of word associations.
- `rvest`: For web scraping articles.
- `SnowballC`: For stemming text.
- `syuzhet`: For extracting sentiment using various lexicons.



